{"version":3,"sources":["webpack:///./src/views/Transaction.vue?1eaf","webpack:///src/views/Transaction.vue","webpack:///./src/views/Transaction.vue?ca79","webpack:///./src/views/Transaction.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","staticClass","_l","data","key","_id","_s","total","amount","userDetail","address","email","phonenumber","status","staticStyle","height","width","attrs","src","transfer","_e","isAdmin","type","id","on","change","previewFile","click","$event","uploadtransfer","accept","products","reject","staticRenderFns","Transactionvue_type_script_lang_js_","name","props","tfimage","transactions","created","_this","setTimeout","populateUser","populateAdmin","mounted","_this2","methods","_this3","$axios","url","localStorage","getItem","headers","token","then","_ref","console","log","catch","err","JSON","stringify","$swal","_this4","_ref2","_this5","sweetalert_min_default","buttons","timer","blob","Blob","formdata","FormData","append","method","_ref3","_ref4","_ref5","response","String","message","_this6","_ref6","i","length","stock","_ref7","_this7","_ref8","e","target","files","views_Transactionvue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/transactions.a4e42612.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('br'),_c('h3',[_vm._v(\"TRANSACTION History\")]),_c('br'),_c('ul',{staticClass:\"list-group\"},_vm._l((_vm.transactions),function(data){return _c('li',{key:data._id,staticClass:\"list-group-item d-flex justify-content-around\"},[_c('div',{staticClass:\"col-4\"},[_vm._v(\"\\n      id Order -> \"+_vm._s(data._id)+\" \"),_c('br'),_vm._v(\"\\n      total  ->  \"+_vm._s(data.total)+\" item \"),_c('br'),_vm._v(\"\\n      amount -> $ \"+_vm._s(data.amount)),_c('br'),_vm._v(\"\\n      sent to -> \"+_vm._s(data.userDetail.address)+\" \"),_c('br'),_vm._v(\"\\n      email -> \"+_vm._s(data.userDetail.email)+\"\\n      phone number -> \"+_vm._s(data.userDetail.phonenumber)+\" \"),_c('br'),_vm._v(\"\\n      status -> \"+_vm._s(data.status)+\" \"),_c('br'),(data.transfer)?_c('img',{staticStyle:{\"height\":\"200px\",\"width\":\"200px\"},attrs:{\"src\":data.transfer}}):_vm._e()]),(_vm.isAdmin === false && data.status === 'wait for payment')?_c('input',{staticClass:\"form-control\",attrs:{\"type\":\"file\",\"id\":\"addproductimage\"},on:{\"change\":_vm.previewFile}}):_vm._e(),(_vm.isAdmin === false && data.status === 'wait for payment')?_c('button',{staticClass:\"btn btn-secondary\",on:{\"click\":function($event){return _vm.uploadtransfer(data._id)}}},[_vm._v(\"upload transfer\")]):_vm._e(),_c('br'),(_vm.isAdmin === true && data.status === 'paid')?_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){return _vm.accept(data._id, data.products)}}},[_vm._v(\"Accept Order\")]):_vm._e(),(_vm.isAdmin === true && data.status === 'paid')?_c('button',{staticClass:\"btn btn-danger\",on:{\"click\":function($event){return _vm.reject(data._id)}}},[_vm._v(\"reject order\")]):_vm._e(),(_vm.isAdmin === false && data.status === 'paid')?_c('button',[_vm._v(\" Waiting for shipping. . .\")]):_vm._e(),(data.status === 'cancelled' )?_c('p',[_vm._v(\"Order Cancelled by Admin, because of stock are not ready\")]):_vm._e()])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div><br>\n    <h3>TRANSACTION History</h3><br>\n    <ul class=\"list-group\">\n      <li\n        class=\"list-group-item d-flex justify-content-around\"\n        v-for=\"data in transactions\" :key=\"data._id\"\n      >\n        <div class=\"col-4\">\n        id Order -> {{data._id}} <br>\n        total  ->  {{data.total}} item <br>\n        amount -> $ {{data.amount}}<br>\n        sent to -> {{data.userDetail.address}} <br>\n        email -> {{data.userDetail.email}}\n        phone number -> {{data.userDetail.phonenumber}} <br>\n        status -> {{data.status}} <br>\n        <img style=\"height:200px; width:200px;\" v-bind:src=\"data.transfer\" v-if=\"data.transfer\" >\n        </div>\n        <input v-if=\"isAdmin === false && data.status === 'wait for payment'\" type=\"file\" class=\"form-control\" @change=\"previewFile\" id=\"addproductimage\">\n        <button @click=\"uploadtransfer(data._id)\" v-if=\"isAdmin === false && data.status === 'wait for payment'\" class=\"btn btn-secondary\">upload transfer</button><br>\n        <button @click=\"accept(data._id, data.products)\" v-if=\"isAdmin === true && data.status === 'paid'\" class=\"btn btn-primary\">Accept Order</button>\n        <button @click=\"reject(data._id)\" v-if=\"isAdmin === true && data.status === 'paid'\" class=\"btn btn-danger\" >reject order</button>\n        <button v-if=\"isAdmin === false && data.status === 'paid'\"> Waiting for shipping. . .</button>\n        <p v-if=\"data.status === 'cancelled' \">Order Cancelled by Admin, because of stock are not ready</p>\n        <!-- <b-button</b-button> -->\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport swal from 'sweetalert';\n\nexport default {\n  name: \"Transaction\",\n  props: [\"isLogin\", \"userId\", \"isAdmin\"],\n  data: function() {\n    return {\n      tfimage : \"\",\n      transactions: []\n    };\n  },\n  created(){\n    if(this.isAdmin === false){\n      setTimeout( ()=>{\n        this.populateUser()\n      }, 2000)\n    } else { \n      setTimeout(()=>{\n        this.populateAdmin()\n      }, 2000)\n    }\n  },\n  mounted() {\n    if(this.isAdmin === false){\n      setTimeout( ()=>{\n        this.populateUser()\n      }, 2000)\n    } else { \n      setTimeout(()=>{\n        this.populateAdmin()\n      }, 2000)\n    }\n  },\n  methods : {\n    populateUser () {\n      this.$axios({\n        methods: \"get\",\n        url: \"http://35.240.223.244/cart/\"+ localStorage.getItem('user'),\n        headers: {\n          token: localStorage.getItem('token'),\n          id: localStorage.getItem('user')\n        }\n        })\n        .then(({data})=>{\n          console.log(data)\n          this.transactions = data\n        })\n        .catch(err=>{\n          console.log(JSON.stringify(err))\n          this.$swal(\"error\",\"internal server error\", \"error\")\n        })\n    },\n    populateAdmin () {\n      this.$axios({\n        methods: \"get\",\n        url: \"http://35.240.223.244/carts\",\n        headers: {\n          token: localStorage.getItem('token'),\n          id: localStorage.getItem('user')\n        }\n        })\n        .then(({data})=>{\n          console.log(data)\n          this.transactions = data\n        })\n        .catch(err=>{\n          console.log(err)\n          this.$swal(\"error\",\"internal server error\", \"error\")\n        })\n    },\n    uploadtransfer(id){\n      console.log(id)\n      if (this.tfimage === \"\") {\n        this.$swal('Please add product image')\n      } else {\n        console.log(\"upload\")\n        swal('Upload Your Image...', {\n          buttons: false,\n          timer: 200\n        })\n        const blob = new Blob([this.tfimage], {\n          type: this.tfimage.type\n        })\n        const formdata = new FormData()\n        formdata.append('image', blob)\n        this.$axios({\n          method: 'post',\n          url: 'http://35.240.223.244/uploadimg',\n          headers: {\n            token: localStorage.getItem('token'),\n            id: localStorage.getItem('user')\n          },\n          data: formdata\n        })\n          .then(({ data }) => {\n            this.tfimage = data\n            console.log(\"selesai upload\")\n            swal('Updating your order status...', {\n              buttons: false,\n              timer: 100\n            })\n            this.$axios({\n              method: 'put',\n              url: 'http://35.240.223.244/cart/'+id,\n              headers: {\n                id: localStorage.getItem('user'),\n                token: localStorage.getItem('token')\n              },\n              data: {\n                transfer : this.tfimage,\n                status : \"paid\"\n              }\n            })\n              .then(({ data }) => {\n                console.log('created => ' + JSON.stringify(data))\n                this.tfimage = \"\"\n                this.$swal('Success', 'Your Order Updated', 'success')\n                this.populateUser()\n              })\n              .catch(err => {\n                this.tfimage = \"\"\n                this.$swal('Error', 'Internal Server Error', 'error')\n                console.log('error di db')\n                console.log(err)\n              })\n          })\n          .catch(({ response }) => {\n            this.tfimage = \"\"\n            this.$swal(\n              'Error Status : ' + String(response.status),\n              response.data.message,\n              'error'\n            )\n              console.log(\"error pas upload image\")\n          })\n      }\n    },\n    accept (id, products) {\n      this.$axios({\n              method: 'put',\n              url: 'http://35.240.223.244/cart/'+id,\n              headers: {\n                id: localStorage.getItem('user'),\n                token: localStorage.getItem('token')\n              },\n              data: {\n                status : \"shipped\"\n              }\n            })\n              .then(({ data }) => {\n                console.log('created => ' + JSON.stringify(data))\n                this.tfimage = \"\"\n                this.$swal('Success', 'Your Order Updated', 'success')\n                \n                for(let i =0; i < products.length; i++){\n                  this.$axios({\n                    method: 'put',\n                    url: 'http://35.240.223.244/product/'+products[i]._id,\n                    headers : {\n                      token : localStorage.getItem('token'),\n                      id : localStorage.getItem('user')\n                    },\n                    data : {\n                      stock : products[i].stock - products[i].total\n                    }\n                  })\n                  .then(({response})=>{\n                    this.populateAdmin()\n                  })\n                  .catch(err=>{\n                    this.populateAdmin()\n                    this.$swal('Error', 'Internal Server Error',    'error')\n                    console.log(err)\n                    console.log('error di db pas update stock')\n                  })\n                }\n              })\n              .catch(err => {\n                this.tfimage = \"\"\n                this.$swal('Error', 'Internal Server Error', 'error')\n                console.log('error di db')\n                console.log(err)\n              })\n    },\n    reject (id) {\n      this.$axios({\n              method: 'put',\n              url: 'http://35.240.223.244/cart/'+id,\n              headers: {\n                id: localStorage.getItem('user'),\n                token: localStorage.getItem('token')\n              },\n              data: {\n                status : \"cancelled\"\n              }\n            })\n              .then(({ data }) => {\n                console.log('created => ' + JSON.stringify(data))\n                this.tfimage = \"\"\n                this.$swal('Success', 'Your Order Updated', 'success')\n                this.populateAdmin()\n              })\n              .catch(err => {\n                this.tfimage = \"\"\n                this.$swal('Error', 'Internal Server Error', 'error')\n                console.log('error di db')\n                console.log(err)\n                this.populateAdmin()\n              })\n    },\n    previewFile (e) {\n      this.tfimage = e.target.files[0]\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Transaction.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Transaction.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Transaction.vue?vue&type=template&id=5bdac618&\"\nimport script from \"./Transaction.vue?vue&type=script&lang=js&\"\nexport * from \"./Transaction.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}