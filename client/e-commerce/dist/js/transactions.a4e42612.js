(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["transactions"],{"0d43":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("br"),r("h3",[t._v("TRANSACTION History")]),r("br"),r("ul",{staticClass:"list-group"},t._l(t.transactions,function(e){return r("li",{key:e._id,staticClass:"list-group-item d-flex justify-content-around"},[r("div",{staticClass:"col-4"},[t._v("\n      id Order -> "+t._s(e._id)+" "),r("br"),t._v("\n      total  ->  "+t._s(e.total)+" item "),r("br"),t._v("\n      amount -> $ "+t._s(e.amount)),r("br"),t._v("\n      sent to -> "+t._s(e.userDetail.address)+" "),r("br"),t._v("\n      email -> "+t._s(e.userDetail.email)+"\n      phone number -> "+t._s(e.userDetail.phonenumber)+" "),r("br"),t._v("\n      status -> "+t._s(e.status)+" "),r("br"),e.transfer?r("img",{staticStyle:{height:"200px",width:"200px"},attrs:{src:e.transfer}}):t._e()]),!1===t.isAdmin&&"wait for payment"===e.status?r("input",{staticClass:"form-control",attrs:{type:"file",id:"addproductimage"},on:{change:t.previewFile}}):t._e(),!1===t.isAdmin&&"wait for payment"===e.status?r("button",{staticClass:"btn btn-secondary",on:{click:function(r){return t.uploadtransfer(e._id)}}},[t._v("upload transfer")]):t._e(),r("br"),!0===t.isAdmin&&"paid"===e.status?r("button",{staticClass:"btn btn-primary",on:{click:function(r){return t.accept(e._id,e.products)}}},[t._v("Accept Order")]):t._e(),!0===t.isAdmin&&"paid"===e.status?r("button",{staticClass:"btn btn-danger",on:{click:function(r){return t.reject(e._id)}}},[t._v("reject order")]):t._e(),!1===t.isAdmin&&"paid"===e.status?r("button",[t._v(" Waiting for shipping. . .")]):t._e(),"cancelled"===e.status?r("p",[t._v("Order Cancelled by Admin, because of stock are not ready")]):t._e()])}),0)])},a=[],s=r("1940"),n=r.n(s),i={name:"Transaction",props:["isLogin","userId","isAdmin"],data:function(){return{tfimage:"",transactions:[]}},created:function(){var t=this;!1===this.isAdmin?setTimeout(function(){t.populateUser()},2e3):setTimeout(function(){t.populateAdmin()},2e3)},mounted:function(){var t=this;!1===this.isAdmin?setTimeout(function(){t.populateUser()},2e3):setTimeout(function(){t.populateAdmin()},2e3)},methods:{populateUser:function(){var t=this;this.$axios({methods:"get",url:"http://35.240.223.244/cart/"+localStorage.getItem("user"),headers:{token:localStorage.getItem("token"),id:localStorage.getItem("user")}}).then(function(e){var r=e.data;console.log(r),t.transactions=r}).catch(function(e){console.log(JSON.stringify(e)),t.$swal("error","internal server error","error")})},populateAdmin:function(){var t=this;this.$axios({methods:"get",url:"http://35.240.223.244/carts",headers:{token:localStorage.getItem("token"),id:localStorage.getItem("user")}}).then(function(e){var r=e.data;console.log(r),t.transactions=r}).catch(function(e){console.log(e),t.$swal("error","internal server error","error")})},uploadtransfer:function(t){var e=this;if(console.log(t),""===this.tfimage)this.$swal("Please add product image");else{console.log("upload"),n()("Upload Your Image...",{buttons:!1,timer:200});var r=new Blob([this.tfimage],{type:this.tfimage.type}),o=new FormData;o.append("image",r),this.$axios({method:"post",url:"http://35.240.223.244/uploadimg",headers:{token:localStorage.getItem("token"),id:localStorage.getItem("user")},data:o}).then(function(r){var o=r.data;e.tfimage=o,console.log("selesai upload"),n()("Updating your order status...",{buttons:!1,timer:100}),e.$axios({method:"put",url:"http://35.240.223.244/cart/"+t,headers:{id:localStorage.getItem("user"),token:localStorage.getItem("token")},data:{transfer:e.tfimage,status:"paid"}}).then(function(t){var r=t.data;console.log("created => "+JSON.stringify(r)),e.tfimage="",e.$swal("Success","Your Order Updated","success"),e.populateUser()}).catch(function(t){e.tfimage="",e.$swal("Error","Internal Server Error","error"),console.log("error di db"),console.log(t)})}).catch(function(t){var r=t.response;e.tfimage="",e.$swal("Error Status : "+String(r.status),r.data.message,"error"),console.log("error pas upload image")})}},accept:function(t,e){var r=this;this.$axios({method:"put",url:"http://35.240.223.244/cart/"+t,headers:{id:localStorage.getItem("user"),token:localStorage.getItem("token")},data:{status:"shipped"}}).then(function(t){var o=t.data;console.log("created => "+JSON.stringify(o)),r.tfimage="",r.$swal("Success","Your Order Updated","success");for(var a=0;a<e.length;a++)r.$axios({method:"put",url:"http://35.240.223.244/product/"+e[a]._id,headers:{token:localStorage.getItem("token"),id:localStorage.getItem("user")},data:{stock:e[a].stock-e[a].total}}).then(function(t){t.response;r.populateAdmin()}).catch(function(t){r.populateAdmin(),r.$swal("Error","Internal Server Error","error"),console.log(t),console.log("error di db pas update stock")})}).catch(function(t){r.tfimage="",r.$swal("Error","Internal Server Error","error"),console.log("error di db"),console.log(t)})},reject:function(t){var e=this;this.$axios({method:"put",url:"http://35.240.223.244/cart/"+t,headers:{id:localStorage.getItem("user"),token:localStorage.getItem("token")},data:{status:"cancelled"}}).then(function(t){var r=t.data;console.log("created => "+JSON.stringify(r)),e.tfimage="",e.$swal("Success","Your Order Updated","success"),e.populateAdmin()}).catch(function(t){e.tfimage="",e.$swal("Error","Internal Server Error","error"),console.log("error di db"),console.log(t),e.populateAdmin()})},previewFile:function(t){this.tfimage=t.target.files[0]}}},l=i,c=r("2877"),u=Object(c["a"])(l,o,a,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=transactions.a4e42612.js.map